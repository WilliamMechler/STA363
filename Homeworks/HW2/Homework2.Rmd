---
title: 'Homework #2'
author: "William Mechler"
date: "2/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*** 

#### Loading packages needed for the problems
```{r, loadPackages, message=FALSE}
library(tidyverse)
library(knitr)
library(ggfortify)
library(emmeans)
```

## Problem 1
An experiment was conducted to determine the time taken for individuals to read a list of words. Specifically, individuals were tasked with reading a list of color names in two settings: subjects would read a list of colors written in a different color (e.g., blue written in red and red in purple) and then subjects would read the list written in black (e.g., blue, red, purple). Each individual was randomly assigned the order in which to read the two list. The experimenters are interested in determine if the font color/writing style influences reading time. Specifically they wish to determine if the different writing styles result in a mean difference in time to read the list.

### Data Source for Problem 1
J.R. Stroop (1935). "Studies of Interference in Serial Verbal Reactions", Journal of Experimental Psychology, Vol 18, pp643-662

*** 

#### Problem 1 Part 1
**Comment on the design of the experiment. Specifically state all the design elements in the context of the problem: the experimental units, the response variable(s), the factor, factor levels, the treatments, and the steps the experimenter took in an attempt to control for nuisance variation or confounding variables.** 
<br/>
The experimental units would be the individuals taking part in the experiment. The response variable would be their time taken to complete each reading. The factor would be the color of the reading list which as two factor levels being, written all in black or colors written in a different color. Then the treatments would just be the order in which they took the tests. Finally the steps taken to control nuisance variation are they randomly assigned each subject the order in which they took the tests.

<br/>

#### Problem 1 Part 2
**Build an appropriate plot for the design of data. Comment on what you see, including comments on the average and variation in the response. Make sure your plot is properly labeled and would be understandable to an outside viewer (that is, the labels and titles explain the context).**
<br/>
```{r, echo=FALSE}
color <- read.csv("color_interference.csv")

color.data <- color %>%
  pivot_longer(c(DiffCol, Black), names_to="EvalType", values_to="Mean") %>%
  mutate(EvalType=factor(EvalType, levels=c("DiffCol","Black")))

# Make profile plot with mean overlays
ggplot(color.data, aes(x = EvalType, y = Mean)) + 
  geom_boxplot() +
  geom_point(aes(group = Subj, color = Subj), alpha = 0.4) +
  geom_line(aes(group = Subj, color = Subj), alpha = 0.4) + 
  stat_summary(fun = "mean", size = 3, geom = "point", color="red") +
  stat_summary(fun = "mean", size = 1, geom = "line", color="red", aes(group = 1)) +
  theme(legend.position = "none") +
  ylab("Time to complete test") +
  xlab("Test type") 

```
<br/>
It appears that not only does the Black colored test have less variation when compared to the Different Color test. It also appears to show that on average people took less time completing the Black colored test when compared to the Different Colored test.
<br/>

#### Problem 1 Part 3
**Perform the appropriate statistical analysis for this design.**
```{r, echo=FALSE}
t.test(color$DiffCol, color$Black, paired=TRUE)
```
<br/>
With a p-value of 0.01624 we can say that their is a significant difference with a 95% confidence, when comparing the Different color test times with the Black colored test times.
<br/>

#### Problem 1 Part 4
**Perform a residual analysis for the statistical method chosen in part 3.**
```{r, echo=FALSE}
color.diff <- color %>%
  mutate(Difference = DiffCol - Black)

ggplot(color.diff) + 
  geom_qq(aes(sample = Difference)) + 
  geom_qq_line(aes(sample = Difference))
```
<br/>
From the above plot we can see that in general our data looks to be in order. The only thing of note is that at the under and lower ends of the graph the data seems to move away from our line of best fit. This can be most clearly seen at the upper end of our graph.
<br/>

#### Problem 1 Part 5
**State the conclusion of the experiment, in context.**
<br/>
From our analysis we can state that, yes the different writing styles resulted in a mean difference from the two different types of tests. More specifaly we can state that the Black writing style resulted in a lower mean time when compared to the Different colored test
<br/>

***

## Problem 2
An experiment was conduct to compare whether two compound X and compound Y were protective in a mouse model of middle cerebral artery occlusion (MCAO).The end point of the study was infarct volume measured from serial brain sections and staining with hematoxylinâ€“eosin. Mice were randomly assigned to three groups, vehicle treatment(control), compound X and compound Y. In the data set, the three groups are coded as: 1 = vehicle, 2 = compound X and 3 = compound Y.  read the list.

### Data Source for Problem 2
 P. Schlattman and U. Dirnagl (2010). "Statistics in Experimental Cerebrovascular Research: Comparison of More then Two Groups with a Continuous Outcome Variable," Journal of Cerebral Blood Flow & Metabolism, Vol. 30, pp. 1558-1563

***

#### Problem 2 Part 1
**Comment on the design of the experiment. Specifically state all the design elements in the context of the problem: the experimental units, the response variable(s), the factor, factor levels, the treatments, and the steps the experimenter took in an attempt to control for nuisance variation or confounding variables.**
<br/>

The experimental units were the mice assigned to each factor. Those factors being compound X, compound Y and vehicle. Each factor only has one factor level so the treatments are compound X, compound Y and vehicle. In a special note vehicle is being considered as the control. The response variable is the infarct volume measured after each test.


#### Problem 2 Part 2
**Create a factor version of the variable that requires it.**
```{r, echo=FALSE}
mice_data <- read.csv("infarct.csv") %>%
    mutate(Treatment=factor(Treatment, 1:3, labels=c("vehicle",
                                                     "compound X",
                                                     "compound Y")))
glimpse(mice_data)
```

#### Problem 2 Part 3
**Perform a meaning/helping EDA for this data. Comment on what you see, including comment on average and variation in foam index.**
```{r, echo=FALSE}
ggplot(mice_data, aes(x=Treatment, y=Volume)) + 
  geom_boxplot( col="gray40") +
  stat_summary(fun=mean, geom="point", shape=21, stroke=2, fill="white", color="blue")+
  labs(x="Treatments", y="Infarct Volume Measured") + 
  theme_bw()
```
<br/>
From the above plot we can see that when we compare both Compound X and Y to Vehicle we see that Compound Y looks to have a lower average volume when compared to Compound X and Vehicle. As well it appears to have a smaller variation as well.
<br/>

#### Problem 2 Part 4
**Perform the appropriate statistical analysis for this design. Cite the statistics value, degrees of freedom, p-value, and the conclusion in problem context.**
```{r, echo=FALSE}
mice_aov <- aov(Volume ~ Treatment, data=mice_data)

summary(mice_aov)
```
<br/>
From the above output we can see we have a f-value of 5.79 and a P-value of 0.00628 with 2 degrees of freedom. With these values can can conclude that their is a significant difference in the response variable (VOlume) depending on which treatment was used.
<br/>

#### Problem 2 Part 5
**Perform a residual analysis for the statistical method chosen in part 4 to check the model assumptions.**
```{r, echo=FALSE}
autoplot(mice_aov)
```
<br/>
When we look at our Normal Q-Q plot our data falls more or less where we expect it to. The only thing I see wrong with the plots come from the Residuals vs Fitted as the values seem to be fanning out. This should be kept in mind for any conclusions from this analysis.
<br/>


#### Problem 2 Part 6
**Perform appropriate multiple comparisons if necessary and report the results in context.  You must provide a defense of your choice to use Tukey or Dunnett.**
```{r, echo=FALSE}
mice.treatment <- emmeans(mice_aov, "Treatment")
contrast(mice.treatment, "trt.vs.ctrl", ref=1)
```
<br/>
For this part of the problem I used the Dunnett method because it stated in the info for this experiment that the treatment "vehicle" would be considered the control. Because we have a control to compare Compound X and Y to it makes more sense to use Dunnett instead of the Tukey method. Also from the comparison above we can see there is a significant difference when Compound Y is compared to Vehicle with a p-value of .0081. However when we compared Compound X to Vehicle we got a p-value of .9182, with this value we can say that our data shows no significant difference when comparing Compound X to Vehicle.
<br/>