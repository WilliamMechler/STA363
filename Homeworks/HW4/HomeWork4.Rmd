---
title: "HomeWork4"
author: "William Mechler"
date: "3/29/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, loadPackages, message=FALSE, echo=FALSE}
library(knitr)
library(ggfortify)
library(knitr)
library(ggplot2)
library(gridExtra)
library(kableExtra)
library(plotly)
library(emmeans)
library(GGally)
library(tidyverse)
library(lindia)
library(car)
```


### Question 1
**We see from our scatter plot above that none of the variables individually have a high correlation with respect to REs. In this case a high correlation being more then .800 or -.800. However we due seem to have potential multicollinearity when it comes to Weight and BMI which is the most clear example. But we may also have multicollinearity issues with a correlation of .783. Age and Weight also may be multicollinearity with a correlation of -.505.**

```{r, echo=FALSE}
Rehabfull <- read.csv("data_REs.csv")
RehabNumeric <- Rehabfull %>%
  select(-c(Sex,FOIS))
ggpairs(RehabNumeric)
```

***



### Question 2
**Their doesn't seems to be any assumption violations based on the above residual diagonstic plots. However we do see one or two points in the Residuals vs Fitted and Scale-Location plot which might be considered unusual.**

```{r message=FALSE, warning=FALSE}
full.fit <- lm(REs ~ Sex + Age + Weight + BMI + BNP + Grip + FOIS + Sex:Weight, data=Rehabfull)
autoplot(full.fit)
```


***

### Question 3
<br/>

$$REs = \beta_0 + \beta_1(Male) + \beta_2(Age) + \beta_3(Weight) + \beta_4(BMI) + \beta_5(BNP) + \beta_6(Grip) + \beta_7(FOIS) + \beta_8(Sex * Weight) + \varepsilon$$

***

### Question 4
**Yes I do think weight on REs depends on sex. From the above model summary we can see that with a p-value of 0.021 our interaction of SexMale and weight is significant.**

```{r message=FALSE, warning=FALSE}
summary(full.fit)
```

<br/>

### Question 5
**Out of the two models I prefer old new model as from the above anova output shows us. As it shows with a p-value of 0.0468 with a F-stat of 2.74 that Weight, BMI and the interaction of Sex to Weight are significant to our model.With this we can reject the null hypothesis.**

```{r message=FALSE, warning=FALSE}
fit.Q5 <- lm(REs ~ Sex + Age + BNP + Grip + FOIS, data=Rehabfull)
autoplot(fit.Q5)

anova(fit.Q5, full.fit)
```


***

<br/>

### Question 6
**Yes there are concerns of multicollinearity based on our vif output. Normally a value around 5 and up is something to worry about and with Weight having a value of 6.714 is concerning. Also our BMI has a value of 4.189 so we should also note that as well.**

```{r message=FALSE, warning=FALSE}
vif(full.fit)
```


***

<br/>

### Question 7
**From our Cook's distance plots we see three concerning points, those being 79, 90 and 112. 90 seems to be the worst point so we will remove it and fit a new model without it.**

**After 90 our many of our Coefficients substantially changed for example our Intercept went from 49.54 to 59.75 without point 90. Also our SexMale went from 41.30 to 15.80. Though all the coefficients changed our Intercept and Sexmale were the most affected.**

```{r message=FALSE, warning=FALSE}
autoplot(full.fit, which=c(4,6))

Rehabfullnew <- Rehabfull %>%
  filter(row_number()!=90)

fit.Q7 <- lm(REs ~ Sex + Age + Weight + BMI + BNP + Grip + FOIS + Sex:Weight, data=Rehabfullnew)
summary(fit.Q7)
```


***

<br/>

### Question 8
**The below code adds the new BNP to our data set.**

```{r message=FALSE, warning=FALSE}
RehabNewBNP <- read.csv("data_REs.csv") %>%
  mutate(BNP = case_when(BNP < 32 ~ "low",
                            BNP >= 32 & BNP <= 73.5 ~ "middle",
                            BNP > 73.5 ~ "high")) %>%
  mutate(BNP = factor(BNP, levels = c("low","middle","high")))
```


***

<br/>

### Question 9
**If we keep all other variables constant and we had a BNPmiddle then our estimate would change by -1.77 and if it was BNP high it would change by -9.18. In both cases our estimate for Res would go down.**

```{r message=FALSE, warning=FALSE}
fit.Q9 <- lm(REs ~ Sex + Age + Grip + FOIS + BNP, data=RehabNewBNP)
summary(fit.Q9)
```


***

### Question 10
**There is a not a significantly different from BNPlow to BNPmiddle as per our summary above. With a p-value of 0.721 we don't have the evidence to say BNPlow and BNPmiddle are significantly different.**

**Also without changing our model we can not tell if there is a significantly difference between the middle and high groups. As the current p-values for BNPmiddle and BNPhigh are in respect to BNPlow and if they are significantly different. So in our case without changing our model we can not tell if there is a significantly difference from BNP.middle to BNPhigh.**
